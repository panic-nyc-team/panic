{% extends "new_layout.html" %}
{% block title %}Reports{% endblock %}
{% block head %}
  {{ super() }}
{% endblock %}
<body>
{% block content %}
    <section class="mt-5">
        <div class='container pt-5'>
            <div class='row justify-content-center'>
                <div class='row justify-content-center text-center text-white col-lg-12'>
                    <h3>Reports</h3>
                </div>
                <div class="row col-12 mt-3">
                    <table class="table">
                        <thead>
                          <tr>
                            <th scope="col">Title</th>
                            <th scope="col">Type</th>
                            <th scope="col">Status</th>
                            <th scope="col">Last Modified</th>
                            <th scope="col"></th>
                          </tr>
                        </thead>
                        <tbody>
                          {% for report in reports %}
                          <tr>

                            <td><a onclick="reportClick(this)" id="{{ report.id }}" style="font-weight: bold;" type="{{ report.type }}" href="#">{{report.title}}</a></td>
                            <td>{{report.type}}</td>
                            <td>{{report.status}}</td>
                            <td>{{"{:%d, %b %Y : %I:%M %p} EST".format(report.date_created) }}</td>
                              {%if report.status=='done' or report.status=='killed' %}
                                <td><button class="btn btn-primary bg-theme mx-1" onclick="deleteClick(this)" id="{{ report.id }}" type="{{ report.type }}">Delete</button></td>
                              {%else%}
                                <td><p>Wait untill done</p><td>
                              {%endif%}
                          </tr>
                          {% endfor %}

                        </tbody>
                    </table>
                </div>
                <div class='row justify-content-center text-center text-white col-lg-12 mt-3'>
                    <button class="btn btn-primary bg-theme" onclick="newClick()" type="button">Add</button>
                </div>
            </div>
        </div>
    </section>
    <footer></footer>

    <script src='https://code.jquery.com/jquery-3.4.1.slim.min.js' integrity='sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n' crossorigin='anonymous'></script>
    <script src='https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js' integrity='sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo' crossorigin='anonymous'></script>
    <script src='https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js' integrity='sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6' crossorigin='anonymous'></script>
<script>
function deleteClick(e) {
  var type = e.getAttribute("type");
  if(type=="noun"){
    window.location.href = "/deletenounreport?id="+e.id;
  }
  else{
    window.location.href = "/deletereport?id="+e.id;
  }
}

function reportClick(e) {
  var type = e.getAttribute("type");
  if(type=="vscompany"){
  window.location.href = "/reporttest?id="+e.id;
  }
  else if (type=="vssearchquery") {
    window.location.href = "/reporttest?id="+e.id;
  }
  else if(type=="vstag"){
    window.location.href = "/reporttest?id="+e.id;
  }
  else if(type=="noun"){
    window.location.href = "/viewentity?id="+e.id;
  }
  else{
    alert('error');
  }
}
function newClick() {
  window.location.href = "/newreport";
}
</script>
{% endblock %}
</body>
</html>